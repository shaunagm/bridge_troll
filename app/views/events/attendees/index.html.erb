<%= content_for(:header_text, @event.title) %>
<%= content_for(:header_link, event_organizer_tools_path(@event)) %>

<%= render :partial => 'shared/organizer_breadcrumb', locals: {current_page_title: 'Attending students and volunteers'} %>

<section class='organizer-dashboard-section'>
<%= render partial: 'shared/organizer_action', locals: {
  path: event_attendees_path(@event, format: :csv),
  icon: 'fa fa-download',
  text: 'Download Attendee Names CSV',
  style: :inline
} %>
<%= render partial: 'shared/organizer_action', locals: {
  path: event_students_path(@event, format: :csv),
  icon: 'fa fa-download',
  text: 'Download Student Details CSV',
  style: :inline
} %>
</section>

<% if @rsvps.empty? %>
  <p>No one is coming to this workshop yet. ;_;</p>
<% else %>
  <table class="datatable table table-striped table-bordered table-condensed attendees responsive-table">
    <thead>
      <tr>
	<!-- Fields for all -->
        <th class='attendee-name'>Name</th>
        <th class='attendee-role'>Attending As</th>
        <th class='attendee-dietary-info'>Dietary Info</th>
        <th class='attendee-job-details'>Details</th>
        <th class='attendee-gender'>Gender</th>
	<!-- Student only fields -->
        <th class='preevent-contact'>Pre-event Contact?</th>
        <th class='preevent-operating-system'>Operating System</th>
        <th class='attendee-waitlisted'>Waitlisted</th>
	<!-- Mentor only fields -->
        <th class='availability'>Available all day?</th>
        <th class='availability-info'>Constraints</th>
        <th class='volunteer_training'>Training?</th>
        <th class='volunteer_projects'>Possible projects</th>
      </tr>
    </thead>
    <tbody>
      <% @rsvps.each do |rsvp| %>
        <tr>
          <!-- Fields for all -->
          <td>
            <%= render 'shared/viewed_gravatars', :email => rsvp.user.email %>
            <%= link_to rsvp.user.full_name, user_profile_path(rsvp.user) %>
          </td>
          <td data-label="Attending as:"><%= rsvp.role.title %></td>
          <%= content_tag_maybe_hidden(:td, rsvp.dietary_info, 'data-label' => 'Dietary info:') %>
          <td data-label="Job details:"><%= rsvp.job_details %></td>
          <td data-label="Gender:"><%= rsvp.user.gender %></td>
          <!-- Student only fields -->
          <%= content_tag_maybe_hidden(:td, rsvp.preevent_contact, 'data-label' => 'Pre-event contact:') %>
          <%= content_tag_maybe_hidden(:td, rsvp.operating_system.name, 'data-label' => 'Operating system:') %>
          <td data-label="Waitlisted?:"><%= if rsvp.waitlist_position then "yes" else "no" end %></td>
	  <!-- Mentor only fields -->
          <%= content_tag_maybe_hidden(:td, rsvp.availability, 'data-label' => 'Availability:') %>
          <%= content_tag_maybe_hidden(:td, rsvp.availability_info, 'data-label' => 'Availability info:') %>
          <%= content_tag_maybe_hidden(:td, rsvp.volunteer_training, 'data-label' => 'Training:') %>
          <%= content_tag_maybe_hidden(:td, rsvp.volunteer_projects, 'data-label' => 'Projects:') %>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>
